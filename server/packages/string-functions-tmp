~"package"v( @string ~"bind"h( @substring &" str start len pos"v( ~"if"v( ~"="h( @pos ~"+"h( @start @len~)~) $"" ~"if"v( ~">="h( @pos @start~) ~"string-cat"v( ~"string-char-at"h( @str @pos~) ~"substring"h( @str @start @len ~"+"h( @pos #1~)~)~) ~"substring"h( @str @start @len ~"+"h( @pos #1~)~)~)~)&)~) ~"bind"h( @split &" str on"v( ~"let"h( @first-index-of ~"string-index-of"h( @str @on~)~) ~"if"v( ~"="h( #-1 @first-index-of~) ~"if"h( ~"string-eq"h( @str $""~) () ~"cons"h( @str ()~)~) ~"cons"v( ~"substring"v( @str #0 @first-index-of #0~) ~"split"v( ~"substring"v( @str ~"+"h( @first-index-of #1~) ~"-"h( ~"string-length"h( @str~) ~"+"h( @first-index-of #1~)~) #0~) @on~)~)~)&)~)~)