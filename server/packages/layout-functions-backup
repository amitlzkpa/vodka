~"run"v( ~"bind"h( @justify-doc &" doc size"v( ~"if"v( ~"is-empty"h( @doc~) {} ~"begin"v( ~"let"h( @line ~"car"h( @doc~)~) ~"let"h( @fline ~"font"h( ~"light"h( ~"flatten"h( @line~)~) $"Helvetica"~)~) ~"let"h( @fontsize ~"find-best-font"h( @fline @size~)~) ~"cons"h( ~"text-size"h( @fline @fontsize~) ~"justify-doc"h( ~"cdr"h( @doc~) @size~)~)~)~)&)~) ~"bind"h( @find-best-font &" phrase targetwidth"v( ~"let"h( @possiblefonts ~"range"h( #8 #600~)~) ~"let"h( @best #8~) ~"let"h( @find-it &" target prevsize fontsizelist"v( ~"if"v( ~"is-empty"h( @fontsizelist~) @prevsize ~"begin"v( ~"let"h( @fontsize ~"car"h( @fontsizelist~)~) ~"let"h( @width-in-font ~"get-pixel-width"h( ~"text-size"h( @phrase @fontsize~)~)~) ~"if"v( ~">"h( @width-in-font @target~) @prevsize ~"find-it"h( @target @fontsize ~"cdr"h( @fontsizelist~)~)~)~)~)&)~) ~"find-it"h( @targetwidth @best @possiblefonts~)&)~) ^~)