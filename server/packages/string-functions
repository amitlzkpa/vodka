~"begin"v( ( @string-functions) ~"bind"h( @string-substr &" str start len pos"v( ~"if"v( ~"="h( @pos ~"+"h( @start @len~)~) $"" ~"if"v( ~">="h( @pos @start~) ~"string-cat"v( ~"string-char-at"h( @str @pos~) ~"string-substr"h( @str @start @len ~"+"h( @pos #1~)~)~) ~"string-substr"h( @str @start @len ~"+"h( @pos #1~)~)~)~)&)~) ~"bind"h( @string-split &" str on"v( ~"bind"h( @first-index-of ~"string-index-of"h( @str @on~)~) ~"if"v( ~"="h( #-1 @first-index-of~) ~"if"h( ~"string-eq"h( @str $""~) () ~"cons"h( @str ()~)~) ~"cons"v( ~"string-substr"v( @str #0 @first-index-of #0~) ~"string-split"v( ~"string-substr"v( @str ~"+"h( @first-index-of #1~) ~"-"h( ~"string-length"h( @str~) ~"+"h( @first-index-of #1~)~) #0~) @on~)~)~)&)~) ^~)