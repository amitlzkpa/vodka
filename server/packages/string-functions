~"begin"v(~"bind"h(@string-substr &" str start len pos"v(~"if"v(~"="h(@pos ~"+"h(@start @len~)~) $"" ~"if"v(~"or"h(~">"h(@pos @start~) ~"="h(@pos @start~)~) ~"string-cat"h(~"string-char-at"h(@str @pos~) ~"string-substr"h(@str @start @len ~"+"h(@pos #1~)~)~) ~"string-substr"h(@str @start @len ~"+"h(@pos #1~)~)~)~)&)~) ~"bind"h(@string-split &" str on"v(~"begin"v(~"bind"h(@first-index-of ~"string-index-of"h(@str @on~)~) ~"if"v(~"is-error"h(@first-index-of~) (@str) ~"cons"h(~"string-substr"v(@str #0 @first-index-of #0~) ~"string-split"h(~"string-substr"v(@str ~"+"h(@first-index-of #1~) ~"-"h(~"string-len"h(@str~) ~"+"h(@first-index-of #1~)~) #0~) @on~)~)~)~)&)~)~)