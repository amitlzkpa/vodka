~"package"v( @string ~"import"h( @util-functions~) ~"bind"h( @substring-from-with-length &" str start len"v( ~"let"h( @ss-rec &" str start len pos"v( ~"if"v( ~"="h( @pos ~"+"h( @start @len~)~) $"" ~"if"v( ~">="h( @pos @start~) ~"string-cat"v( ~"string-char-at"h( @str @pos~) ~"ss-rec"h( @str @start @len ~"+"h( @pos #1~)~)~) ~"ss-rec"h( @str @start @len ~"+"h( @pos #1~)~)~)~)&)~) ~"ss-rec"h( @str @start @len #0~)&)~) ~"bind"h( @join-on &" strlist separator"v( ~"use"h( @util~) ~"if"v( ~"is-empty"h( @strlist~) $"" ~"if"v( ~"="h( ~"length-of"h( @strlist~) #1~) ~"car"h( @strlist~) ~"string-cat"v( ~"car"h( @strlist~) @separator ~"join-on"h( ~"cdr"h( @strlist~) @separator~)~)~)~)&)~) ~"bind"h( @split-on &" str on"v( ~"let"h( @first-index-of ~"string-index-of"h( @str @on~)~) ~"if"v( ~"="h( #-1 @first-index-of~) ~"if"h( ~"equal"h( @str $""~) () ~"cons"h( @str ()~)~) ~"cons"v( ~"substring-from-with-length"v( @str #0 @first-index-of~) ~"split-on"v( ~"substring-from-with-length"v( @str ~"+"h( @first-index-of #1~) ~"-"h( ~"string-length"h( @str~) ~"+"h( @first-index-of #1~)~)~) @on~)~)~)&)~)~)