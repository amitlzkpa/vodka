~"begin"v(~"bind"h(@lowercase &" nex"v(~"set-nex-style"h($"text-transform" $"lowercase" @nex~)&)~) ~"bind"h(@uppercase &" nex"v(~"set-nex-style"h($"text-transform" $"uppercase" @nex~)&)~) ~"bind"h(@flip-horizontal &" nex"v({[(|(F)| |(L)| |(I)| |(P)|) |(-)| (|(H)| |(O)| |(R)| |(I)| |(Z)| |(O)| |(N)| |(T)| |(A)| |(L)|)] [|[&nbsp;]| (|(f)| |(l)| |(i)| |(p)| |(s)|) |( )| (|(t)| |(e)| |(x)| |(t)|) |( )| (|(h)| |(o)| |(r)| |(i)| |(z)| |(o)| |(n)| |(t)| |(a)| |(l)| |(l)| |(y)|) |(.)| |( )| (|(T)| |(O)| |(D)| |(O)|) |(:)| (|(m)| |(a)| |(k)| |(e)|) |( )| (|(t)| |(h)| |(i)| |(s)|) |( )| (|(m)| |(u)| |(l)| |(t)| |(i)| |(p)| |(l)| |(y)|) |( )| (|(b)| |(y)|) |( )| (|(e)| |(x)| |(i)| |(s)| |(t)| |(i)| |(n)| |(g)|) |( )| (|(s)| |(c)| |(a)| |(l)| |(e)|) |( )| (|(f)| |(a)| |(c)| |(t)| |(o)| |(r)|) |(.)|]} ~"set-nex-style"h($"transform" $"scale(-1,1)" @nex~)&)~) ~"bind"h(@flip-vertical &" nex"v({[(|(F)| |(L)| |(I)| |(P)|) |(-)| (|(V)| |(E)| |(R)| |(T)| |(I)| |(C)| |(A)| |(L)|)] [|[&nbsp;]| (|(f)| |(l)| |(i)| |(p)| |(s)|) |( )| (|(t)| |(e)| |(x)| |(t)|) |( )| (|(v)| |(e)| |(r)| |(t)| |(i)| |(c)| |(a)| |(l)| |(l)| |(y)|) |(.)| |( )| (|(T)| |(O)| |(D)| |(O)|) |(:)| (|(m)| |(a)| |(k)| |(e)|) |( )| (|(t)| |(h)| |(i)| |(s)|) |( )| (|(m)| |(u)| |(l)| |(t)| |(i)| |(p)| |(l)| |(y)|) |( )| (|(b)| |(y)|) |( )| (|(e)| |(x)| |(i)| |(s)| |(t)| |(i)| |(n)| |(g)|) |( )| (|(s)| |(c)| |(a)| |(l)| |(e)|) |( )| (|(f)| |(a)| |(c)| |(t)| |(o)| |(r)|) |(.)|]} ~"set-nex-style"h($"transform" $"scale(1,-1)" @nex~)&)~) ~"bind"h(@padding-bottom &" nex val"v({[(|(P)| |(A)| |(D)| |(D)| |(I)| |(N)| |(G)|) |(-)| (|(B)| |(O)| |(T)| |(T)| |(O)| |(M)|)] [|[&nbsp;]| (|(s)| |(e)| |(t)| |(s)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(b)| |(o)| |(t)| |(t)| |(o)| |(m)|) |( )| (|(p)| |(a)| |(d)| |(d)| |(i)| |(n)| |(g)|) |( )| (|(f)| |(o)| |(r)|) |( )| (|(a)|) |( )| (|(n)| |(e)| |(x)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"padding-bottom" ~"to-string"h(@val~) @nex~)&)~) ~"bind"h(@padding-top &" nex val"v({[(|(P)| |(A)| |(D)| |(D)| |(I)| |(N)| |(G)|) |(-)| (|(T)| |(O)| |(P)|)] [|[&nbsp;]| |[&nbsp;]| (|(s)| |(e)| |(t)| |(s)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(t)| |(o)| |(p)|) |( )| (|(p)| |(a)| |(d)| |(d)| |(i)| |(n)| |(g)|) |( )| (|(f)| |(o)| |(r)|) |( )| (|(a)|) |( )| (|(n)| |(e)| |(x)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"padding-top" ~"to-string"h(@val~) @nex~)&)~) ~"bind"h(@padding-left &" nex val"v({[(|(P)| |(A)| |(D)| |(D)| |(I)| |(N)| |(G)|) |(-)| (|(L)| |(E)| |(F)| |(T)|)] [|[&nbsp;]| |[&nbsp;]| (|(s)| |(e)| |(t)| |(s)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(l)| |(e)| |(f)| |(t)|) |( )| (|(p)| |(a)| |(d)| |(d)| |(i)| |(n)| |(g)|) |( )| (|(f)| |(o)| |(r)|) |( )| (|(a)|) |( )| (|(n)| |(e)| |(x)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"padding-left" ~"to-string"h(@val~) @nex~)&)~) ~"bind"h(@padding-right &" nex val"v({[(|(P)| |(A)| |(D)| |(D)| |(I)| |(N)| |(G)|) |(-)| (|(R)| |(I)| |(G)| |(H)| |(T)|)] [|[&nbsp;]| |[&nbsp;]| (|(s)| |(e)| |(t)| |(s)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(r)| |(i)| |(g)| |(h)| |(t)|) |( )| (|(p)| |(a)| |(d)| |(d)| |(i)| |(n)| |(g)|) |( )| (|(f)| |(o)| |(r)|) |( )| (|(a)|) |( )| (|(n)| |(e)| |(x)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"padding-right" ~"to-string"h(@val~) @nex~)&)~) ~"bind"h(@text-caps &" nex"v({[(|(T)| |(E)| |(X)| |(T)|) |(-)| (|(C)| |(A)| |(P)| |(S)|)] [|[&nbsp;]| (|(m)| |(a)| |(k)| |(e)| |(s)|) |( )| (|(t)| |(e)| |(x)| |(t)|) |( )| (|(a)| |(l)| |(l)|) |(-)| (|(c)| |(a)| |(p)| |(s)|) |( )| (|(w)| |(i)| |(t)| |(h)| |(o)| |(u)| |(t)|) |( )| (|(c)| |(h)| |(a)| |(n)| |(g)| |(i)| |(n)| |(g)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(l)| |(e)| |(t)| |(t)| |(e)| |(r)| |(s)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"text-transform" $"uppercase" @nex~)&)~) ~"bind"h(@text-color &" nex color"v({[(|(T)| |(E)| |(X)| |(T)|) |(-)| (|(C)| |(O)| |(L)| |(O)| |(R)|)] [|[&nbsp;]| (|(c)| |(h)| |(a)| |(n)| |(g)| |(e)| |(s)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(c)| |(o)| |(l)| |(o)| |(r)|) |( )| (|(o)| |(f)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(t)| |(e)| |(x)| |(t)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"color" @color @nex~)&)~) ~"bind"h(@font &" nex fontname"v({[(|(F)| |(O)| |(N)| |(T)|)] [|[&nbsp;]| (|(c)| |(h)| |(a)| |(n)| |(g)| |(e)| |(s)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(f)| |(o)| |(n)| |(t)|) |( )| (|(o)| |(f)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(t)| |(e)| |(x)| |(t)|) |( )| |(-)| |( )| (|(u)| |(s)| |(e)|) |( )| (|(h)| |(t)| |(m)| |(l)|) |( )| (|(f)| |(o)| |(n)| |(t)|) |( )| (|(n)| |(a)| |(m)| |(e)| |(s)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"font-family" @fontname @nex~)&)~) ~"bind"h(@text-size &" nex size"v({[(|(T)| |(E)| |(X)| |(T)|) |(-)| (|(S)| |(I)| |(Z)| |(E)|)] [|[&nbsp;]| (|(c)| |(h)| |(a)| |(n)| |(g)| |(e)| |(s)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(s)| |(i)| |(z)| |(e)|) |( )| (|(o)| |(f)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(t)| |(e)| |(x)| |(t)|) |( )| |(-)| |( )| (|(i)| |(n)|) |( )| (|(p)| |(i)| |(x)| |(e)| |(l)| |(s)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"font-size" ~"string-cat"h(~"to-string"h(@size~) $"px"~) @nex~)&)~) ~"bind"h(@background-color &" nex color"v({[(|(B)| |(A)| |(C)| |(K)| |(G)| |(R)| |(O)| |(U)| |(N)| |(D)|) |(-)| (|(C)| |(O)| |(L)| |(O)| |(R)|)] [|[&nbsp;]| (|(s)| |(e)| |(t)| |(s)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(b)| |(a)| |(c)| |(k)| |(g)| |(r)| |(o)| |(u)| |(n)| |(d)|) |( )| (|(c)| |(o)| |(l)| |(o)| |(r)|) |( )| (|(f)| |(o)| |(r)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(n)| |(e)| |(x)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"background-color" @color @nex~)&)~) ~"bind"h(@height &" nex height"v({[(|(H)| |(E)| |(I)| |(G)| |(H)| |(T)|)] [|[&nbsp;]| (|(s)| |(e)| |(t)| |(s)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(h)| |(e)| |(i)| |(g)| |(h)| |(t)|) |( )| (|(f)| |(o)| |(r)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(n)| |(e)| |(x)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"height" ~"string-cat"h(~"to-string"h(@height~) $"px"~) @nex~)&)~) ~"bind"h(@width &" nex width"v({[(|(W)| |(I)| |(D)| |(T)| |(H)|)] [|[&nbsp;]| (|(s)| |(e)| |(t)| |(s)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(w)| |(i)| |(d)| |(t)| |(h)|) |( )| (|(o)| |(f)|) |( )| (|(t)| |(h)| |(e)|) |( )| (|(n)| |(e)| |(x)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"width" ~"string-cat"h(~"to-string"h(@width~) $"px"~) @nex~)&)~) ~"bind"h(@italic &" nex"v({[(|(I)| |(T)| |(A)| |(L)| |(I)| |(C)|)] [|[&nbsp;]| (|(m)| |(a)| |(k)| |(e)| |(s)|) |( )| (|(t)| |(e)| |(x)| |(t)|) |( )| (|(i)| |(t)| |(a)| |(l)| |(i)| |(c)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"font-style" $"italic" @nex~)&)~) ~"bind"h(@bold &" nex"v({[(|(B)| |(O)| |(L)| |(D)|)] [|[&nbsp;]| (|(m)| |(a)| |(k)| |(e)| |(s)|) |( )| (|(t)| |(e)| |(x)| |(t)|) |( )| (|(b)| |(o)| |(l)| |(d)|)] [|[&nbsp;]|]} ~"set-nex-style"h($"font-weight" $"bold" @nex~)&)~) ~"bind"h(@light &" nex"v({[(|(L)| |(I)| |(G)| |(H)| |(T)|)] [|[&nbsp;]| (|(m)| |(a)| |(k)| |(e)| |(s)|) |( )| (|(t)| |(e)| |(x)| |(t)|) |( )| (|(l)| |(i)| |(g)| |(h)| |(t)| |(e)| |(r)|) |( )| (|(w)| |(e)| |(i)| |(g)| |(h)| |(t)|)]} ~"set-nex-style"h($"font-weight" $"lighter" @nex~)&)~) ~"bind"h(@set-nex-style &" stylename styleval nex"v({[(|(S)| |(E)| |(T)|) |(-)| (|(N)| |(E)| |(X)| |(T)|) |(-)| (|(S)| |(T)| |(Y)| |(L)| |(E)|)] [|[&nbsp;]| (|(s)| |(e)| |(t)| |(s)|) |( )| (|(a)| |(n)|) |( )| (|(a)| |(r)| |(b)| |(i)| |(t)| |(r)| |(a)| |(r)| |(y)|) |( )| (|(c)| |(s)| |(s)|) |( )| (|(s)| |(t)| |(y)| |(l)| |(e)|) |( )| (|(f)| |(o)| |(r)|) |( )| (|(a)|) |( )| (|(n)| |(e)| |(x)|)] [|[&nbsp;]|]} ~"let"h(@style-list ~"parse-style"h(~"get-style-from"h(@nex~)~)~) ~"let"h(@new-style-list ~"set-style"h(@stylename @styleval @style-list~)~) ~"apply-style-to"h(~"join-style"h(@new-style-list~) @nex~)&)~) ~"bind"h(@set-style &" stylename styleval stylelist"v(~"if"v(~"has-style"h(@stylename @stylelist~) ~"add-style"h(@stylename @styleval ~"remove-style"h(@stylename @stylelist~)~) ~"add-style"h(@stylename @styleval @stylelist~)~)&)~) ~"bind"h(@parse-style &" stylestring"v(~"let"h(@stylelist ~"string-split"h(@stylestring $";"~)~) ~"let"h(@split-pairs &" lst"v(~"if"v(~"is-empty"h(@lst~) () ~"begin"v(~"let"h(@pair ~"string-split"h(~"car"h(@lst~) $":"~)~) ~"cons"v(@pair ~"split-pairs"h(~"cdr"h(@lst~)~)~)~)~)&)~) ~"split-pairs"h(@stylelist~)&)~) ~"bind"h(@join-style &" stylelist"v(~"if"v(~"is-empty"h(@stylelist~) $"" ~"begin"v(~"let"h(@pair ~"car"h(@stylelist~)~) ~"let"h(@pairstring ~"string-cat"v(~"car"h(@pair~) $":" ~"car"h(~"cdr"h(@pair~)~)~)~) ~"let"h(@remaining ~"join-style"v(~"cdr"h(@stylelist~)~)~) ~"string-cat"v(@pairstring ~"if"v(~"string-eq"h(@remaining $""~) $"" $";"~) @remaining~)~)~)&)~) ~"bind"h(@add-style &" stylename styleval stylelist"v(~"cons"h(~"cons"h(@stylename ~"cons"h(@styleval ()~)~) @stylelist~)&)~) ~"bind"h(@remove-style &" stylename stylelist"v(~"if"v(~"is-empty"h(@stylelist~) () ~"begin"v(~"let"h(@pair ~"car"h(@stylelist~)~) ~"let"h(@name ~"car"h(@pair~)~) ~"if"v(~"string-eq"h(@name @stylename~) ~"cdr"h(@stylelist~) ~"cons"h(@pair ~"remove-style"h(@stylename @stylelist~)~)~)~)~)&)~) ~"bind"h(@has-style &" stylename stylelist"v(~"if"v(~"is-empty"h(@stylelist~) !no ~"begin"v(~"let"h(@name ~"car"h(~"car"h(@stylelist~)~)~) ~"if"v(~"string-eq"h(@stylename @name~) !yes ~"has-style"h(@stylename ~"cdr"h(@stylelist~)~)~)~)~)&)~) ~"bind"h(@string-substr &" str start len pos"v({[(|(S)| |(T)| |(R)| |(I)| |(N)| |(G)|) |(-)| (|(S)| |(U)| |(B)| |(S)| |(T)| |(R)|)] [|[&nbsp;]| (|(r)| |(e)| |(t)| |(u)| |(r)| |(n)| |(s)|) |( )| (|(a)|) |( )| (|(s)| |(u)| |(b)| |(s)| |(t)| |(r)| |(i)| |(n)| |(g)|) |( )| (|(o)| |(f)|) |( )| (|(a)|) |( )| (|(s)| |(t)| |(r)| |(i)| |(n)| |(g)|) |( )| |(-)| |( )| (|(m)| |(u)| |(s)| |(t)|) |( )| (|(p)| |(a)| |(s)| |(s)|) |( )| (|(0)|) |( )| (|(f)| |(o)| |(r)|) |( )| (|(p)| |(o)| |(s)|)]} ~"if"v(~"="h(@pos ~"+"h(@start @len~)~) $"" ~"if"v(~">="h(@pos @start~) ~"string-cat"v(~"string-char-at"h(@str @pos~) ~"string-substr"h(@str @start @len ~"+"h(@pos #1~)~)~) ~"string-substr"h(@str @start @len ~"+"h(@pos #1~)~)~)~)&)~) ~"bind"h(@string-split &" str on"v({[(|(S)| |(T)| |(R)| |(I)| |(N)| |(G)|) |(-)| (|(S)| |(P)| |(L)| |(I)| |(T)|)] [|[&nbsp;]| (|(s)| |(p)| |(l)| |(i)| |(t)| |(s)|) |( )| (|(a)|) |( )| (|(s)| |(t)| |(r)| |(i)| |(n)| |(g)|) |( )| (|(o)| |(n)|) |( )| (|(a)|) |( )| (|(s)| |(e)| |(p)| |(a)| |(r)| |(a)| |(t)| |(o)| |(r)|) |( )| (|(c)| |(h)| |(a)| |(r)|) |(,)| |( )| (|(r)| |(e)| |(t)| |(u)| |(r)| |(n)| |(i)| |(n)| |(g)|) |( )| (|(a)|) |( )| (|(l)| |(i)| |(s)| |(t)|)]} ~"let"h(@first-index-of ~"string-index-of"h(@str @on~)~) ~"if"v(~"="h(@first-index-of #-1~) ~"if"h(~"string-eq"h(@str $""~) () ~"cons"h(@str ()~)~) ~"cons"v(~"string-substr"v(@str #0 @first-index-of #0~) ~"string-split"v(~"string-substr"v(@str ~"+"h(@first-index-of #1~) ~"-"h(~"string-length"h(@str~) ~"+"h(@first-index-of #1~)~) #0~) @on~)~)~)&)~)~)