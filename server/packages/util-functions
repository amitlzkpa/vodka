~"begin"v(~"bind"h(@LOG {}~) ~"bind"h(@log &" nex"v(~"cram"h(~"copy"h(@nex~) @LOG~)&)~) ~"bind"h(@caar &" lst"v(~"car"h(~"car"h(@lst~)~)&)~) ~"bind"h(@cadr &" lst"v(~"car"h(~"cdr"h(@lst~)~)&)~) ~"bind"h(@cdar &" lst"v(~"cdr"h(~"car"h(@lst~)~)&)~) ~"bind"h(@cddr &" lst"v(~"cdr"h(~"cdr"h(@lst~)~)&)~) ~"bind"h(@do-for-each &" f lst"v(~"if"v(~"is-empty"h(@lst~) () ~"cons"h(~""h(@f ~"car"h(@lst~)~) ~"do-for-each"h(@f ~"cdr"h(@lst~)~)~)~)&)~) ~"bind"h(@range &" start end"v(~"if"v(~">"h(@start @end~) () ~"cons"h(@start ~"range"h(~"+"h(@start #1~) @end~)~)~)&)~) ~"bind"h(@lookup &" nex table"v(~"let"h(@r ^~) ~"do-for-each"h(&" entry"v(~"let"h(@key ~"car"h(@entry~)~) ~"if"v(~"equal"h(@key @nex~) ~"set"h(@r ~"car"h(~"cdr"h(@entry~)~)~) ^~)&) @table~) @r&)~) ~"bind"h(@flatten &" lst-to-flatten"v({[(|(F)| |(L)| |(A)| |(T)| |(T)| |(E)| |(N)|)] [(|(F)| |(l)| |(a)| |(t)| |(t)| |(e)| |(n)| |(s)|) |( )| (|(a)|) |( )| (|(l)| |(i)| |(s)| |(t)|) |( )| (|(o)| |(f)|) |( )| (|(l)| |(i)| |(s)| |(t)| |(s)|) |( )| (|(s)| |(u)| |(c)| |(h)|) |( )| (|(a)| |(s)|) |( )| (|(a)|) |( )| (|(d)| |(o)| |(c)|)] [|[&nbsp;]| (|(i)| |(n)| |(t)| |(o)|) |( )| (|(a)|) |( )| (|(s)| |(i)| |(n)| |(g)| |(l)| |(e)|) |( )| (|(l)| |(i)| |(s)| |(t)|) |( )| (|(w)| |(h)| |(e)| |(r)| |(e)|) |( )| (|(e)| |(v)| |(e)| |(r)| |(y)| |(t)| |(h)| |(i)| |(n)| |(g)|) |( )| (|(i)| |(s)|) |( )| (|(a)|) |( )| (|(s)| |(i)| |(b)| |(l)| |(i)| |(n)| |(g)|)]} ~"let"h(@remove-leading-empty-lists &" lst"v(~"if"v(~"is-empty"h(@lst~) @lst ~"begin"v(~"let"h(@t ~"car"h(@lst~)~) [(|(t)| |(h)| |(i)| |(s)|) |( )| (|(i)| |(s)|) |( )| (|(a)| |(n)| |(n)| |(o)| |(y)| |(i)| |(n)| |(g)|) |(,)| |( )| (|(I)|) |( )| (|(n)| |(e)| |(e)| |(d)|) |( )| (|(s)| |(h)| |(o)| |(r)| |(t)|) |( )| (|(c)| |(i)| |(r)| |(c)| |(u)| |(i)| |(t)|) |( )| (|(e)| |(v)| |(a)| |(l)|)] ~"if"v(~"is-list"h(@t~) ~"if"v(~"is-empty"h(@t~) ~"remove-leading-empty-lists"h(~"cdr"h(@lst~)~) @lst~) @lst~)~)~)&)~) ~"let"h(@do-flatten &" lst"v(~"let"h(@usable-lst ~"remove-leading-empty-lists"h(@lst~)~) ~"if"v(~"is-empty"h(@usable-lst~) () ~"begin"v(~"let"h(@first ~"car"h(@usable-lst~)~) ~"if"v(~"is-list"h(@first~) ~"do-flatten"h(~"cons"h(~"car"h(@first~) ~"cons"h(~"cdr"h(@first~) ~"cdr"h(@usable-lst~)~)~)~) ~"cons"h(@first ~"do-flatten"h(~"cdr"h(@usable-lst~)~)~)~)~)~)&)~) ~"do-flatten"h(@lst-to-flatten~)&)~) ~"bind"h(@select-nth-from-list &" n lst"v({[(|(S)| |(E)| |(L)| |(E)| |(C)| |(T)|) |(-)| (|(N)| |(T)| |(H)|) |(-)| (|(F)| |(R)| |(O)| |(M)|) |(-)| (|(L)| |(I)| |(S)| |(T)|)] [|[&nbsp;]| (|(d)| |(o)| |(e)| |(s)|) |( )| (|(w)| |(h)| |(a)| |(t)|) |( )| (|(i)| |(t)|) |( )| (|(s)| |(a)| |(y)| |(s)|) |( )| (|(b)| |(a)| |(s)| |(i)| |(c)| |(a)| |(l)| |(l)| |(y)|)]} ~"if"v(~"="h(@n #0~) ~"car"h(@lst~) ~"select-nth-from-list"h(~"-"h(@n #1~) ~"cdr"h(@lst~)~)~)&)~) ~"bind"h(@list-length &" lst"v({[(|(L)| |(I)| |(S)| |(T)|) |(-)| (|(L)| |(E)| |(N)| |(G)| |(T)| |(H)|)] [|[&nbsp;]| (|(r)| |(e)| |(t)| |(u)| |(r)| |(n)| |(s)|) |( )| (|(l)| |(e)| |(n)| |(g)| |(t)| |(h)|) |( )| (|(o)| |(f)|) |( )| (|(l)| |(i)| |(s)| |(t)|)]} ~"if"v(~"is-empty"h(@lst~) #0 ~"+"h(#1 ~"list-length"h(~"cdr"h(@lst~)~)~)~)&)~)~)