~"package"v( @util ~"bind"h( @LOG {}~) ~"bind"h( @log &" nex"v( ~"cram"h( ~"copy"h( @nex~) @LOG~)&)~) ~"bind"h( @caar &" lst"v( ~"car"h( ~"car"h( @lst~)~)&)~) ~"bind"h( @cadr &" lst"v( ~"car"h( ~"cdr"h( @lst~)~)&)~) ~"bind"h( @cdar &" lst"v( ~"cdr"h( ~"car"h( @lst~)~)&)~) ~"bind"h( @cddr &" lst"v( ~"cdr"h( ~"cdr"h( @lst~)~)&)~) ~"bind"h( @do-for-each &" f lst"v( ~"do-for-each-and-put-in"h( @f @lst ()~)&)~) ~"bind"h( @do-for-each-and-put-in &" f lst dstlst"v( ~"if"v( ~"is-empty"h( @lst~) @dstlst ~"cons"h( ~"f"h( ~"car"h( @lst~)~) ~"do-for-each-and-put-in"h( @f ~"cdr"h( @lst~) @dstlst~)~)~)&)~) ~"bind"h( @range-from-to &" start end"v( ~"if"v( ~">"h( @start @end~) () ~"cons"h( @start ~"range-from-to"h( ~"+"h( @start #1~) @end~)~)~)&)~) ~"bind"h( @flatten &" lst"v( ~"let"h( @accumulator ()~) ~"traverse-atoms-of-and-do"h( @lst &" atom"v( ~"set"h( @accumulator ~"cons"h( @atom @accumulator~)~)&)~) ~"reverse"h( @accumulator~)&)~) ~"bind"h( @reverse &" lst"v( ~"let"h( @accumulator ()~) ~"do-for-each"h( &" n"v( ~"set"h( @accumulator ~"cons"h( @n @accumulator~)~)&) @lst~) @accumulator&)~) ~"bind"h( @traverse-atoms-of-and-do &" lst f"v( ~"if"v( ~"is-empty"h( @lst~) @lst ~"begin"v( ~"let"h( @item ~"car"h( @lst~)~) ~"if"v( ~"is-list"h( @item~) ~"cons"h( ~"traverse-atoms-of-and-do"h( @item @f~) ~"traverse-atoms-of-and-do"h( ~"cdr"h( @lst~) @f~)~) ~"cons"h( ~"f"h( @item~) ~"traverse-atoms-of-and-do"h( ~"cdr"h( @lst~) @f~)~)~)~)~)&)~) ~"bind"h( @traverse-items-satisfying-and-do &" lst testf dof"v( ~"if"v( ~"is-empty"h( @lst~) @lst ~"begin"v( ~"let"h( @item ~"car"h( @lst~)~) ~"if"v( ~"testf"h( @item~) ~"cons"v( ~"dof"h( @item~) ~"traverse-items-satisfying-and-do"h( ~"cdr"h( @lst~) @testf @dof~)~) ~"if"v( ~"is-list"h( @item~) ~"cons"v( ~"traverse-items-satisfying-and-do"h( @item @testf @dof~) ~"traverse-items-satisfying-and-do"h( ~"cdr"h( @lst~) @testf @dof~)~) ~"cons"v( @item ~"traverse-items-satisfying-and-do"h( ~"cdr"h( @lst~) @testf @dof~)~)~)~)~)~)&)~) ~"bind"h( @nth-from &" n lst"v( ~"if"v( ~"="h( @n #0~) ~"car"h( @lst~) ~"nth-from"h( ~"-"h( @n #1~) ~"cdr"h( @lst~)~)~)&)~) ~"bind"h( @length-of &" lst"v( ~"if"v( ~"is-empty"h( @lst~) #0 ~"+"h( #1 ~"length-of"h( ~"cdr"h( @lst~)~)~)~)&)~) ~"bind"h( @list-cat &" lst1 lst2"v( ~"if"v( ~"is-empty"h( @lst1~) ~"copy"h( @lst2~) ~"cons"h( ~"car"h( @lst1~) ~"list-cat"h( ~"cdr"h( @lst1~) @lst2~)~)~)&)~) ~"bind"h( @put-contents-in &" lst dstlst"v( ~"list-cat"h( @lst @dstlst~)&)~) ~"bind"h( @contains-item-satisfying &" lst f"v( ~"if"v( ~"is-empty"h( @lst~) !no ~"or"h( ~"f"h( ~"car"h( @lst~)~) ~"contains-item-satisfying"h( ~"cdr"h( @lst~) @f~)~)~)&)~) ~"bind"h( @with-only-items-satisfying &" lst f"v( ~"if"v( ~"is-empty"h( @lst~) @lst ~"begin"v( ~"let"h( @item ~"car"h( @lst~)~) ~"if"v( ~"f"h( @item~) ~"cons"h( @item ~"with-only-items-satisfying"h( ~"cdr"h( @lst~) @f~)~) ~"with-only-items-satisfying"h( ~"cdr"h( @lst~) @f~)~)~)~)&)~) ~"bind"h( @lookup-key-in &" key table"v( ~"use"h( @util~) ~"let"h( @r ^~) ~"do-for-each"h( &" entry"v( ~"let"h( @possiblekey ~"car"h( @entry~)~) ~"if"v( ~"equal"h( @key @possiblekey~) ~"set"h( @r ~"cadr"h( @entry~)~) ^~)&) @table~) @r&)~) ~"bind"h( @remove-all-entries-with-key-from &" key table"v( ~"if"v( ~"is-empty"h( @table~) () ~"begin"v( ~"let"h( @entry ~"car"h( @table~)~) ~"let"h( @possiblekey ~"car"h( @entry~)~) ~"if"v( ~"equal"h( @key @possiblekey~) ~"remove-all-entries-with-key-from"h( @key ~"cdr"h( @table~)~) ~"cons"h( @entry ~"remove-all-entries-with-key-from"h( @key ~"cdr"h( @table~)~)~)~)~)~)&)~) ~"bind"h( @add-key-value-to &" key value table"v( ~"cons"h( ~"cons"h( @key ~"cons"h( @value ()~)~) @table~)&)~) ~"bind"h( @key-is-in &" key table"v( ~"contains-item-satisfying"h( @table &" entry"v( ~"equal"h( @key ~"car"h( @entry~)~)&)~)&)~)~)